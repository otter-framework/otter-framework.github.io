<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=stylesheet type=text/css href=asciinema-player.css><link rel=preload as=font href=https://otter-framework.dev/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://otter-framework.dev/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://otter-framework.dev/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://otter-framework.dev/main.1ceb5f88fb530d1461e4698b552b7a51a501d32f8035086019853dfa4fd27db3127d1d9e22723bb66a97841e85b8eacb1b23763bbf9f3322bd3b001aaf8f4d87.css integrity="sha512-HOtfiPtTDRRh5GmLVSt6UaUB0y+ANQhgGYU9+k/SfbMSfR2eInI7tmqXhB6FuOrLGyN2O7+fMyK9OwAar49Nhw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>How WebRTC Works - Otter</title><meta name=description content="How do Peers Connect? #Let’s look at a high-level workflow of how a direct connection can be established between two peers. We will use an analogy of a peer Alice sending physical mail to another peer Bob.
How does Alice know where to address her mail to?
Alice will need some mechanism to exchange addresses with Bob to facilitate the delivery, which is known as signaling. This could be a text message or even a pigeon carrier."><link rel=canonical href=https://otter-framework.dev/docs/case-study/web-rtc/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="How WebRTC Works"><meta property="og:description" content="How do Peers Connect? #Let’s look at a high-level workflow of how a direct connection can be established between two peers. We will use an analogy of a peer Alice sending physical mail to another peer Bob.
How does Alice know where to address her mail to?
Alice will need some mechanism to exchange addresses with Bob to facilitate the delivery, which is known as signaling. This could be a text message or even a pigeon carrier."><meta property="og:url" content="https://otter-framework.dev/docs/case-study/web-rtc/"><meta property="og:site_name" content="Otter"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://otter-framework.dev/doks.png"><meta property="og:image:alt" content="Otter"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@getdoks"><meta name=twitter:creator content="@henkverlinde"><meta name=twitter:title content="How WebRTC Works"><meta name=twitter:description content><meta name=twitter:image content="https://otter-framework.dev/doks.png"><meta name=twitter:image:alt content="How WebRTC Works"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://otter-framework.dev/#/schema/organization/1","name":"Doks","url":"https://otter-framework.dev/","sameAs":["https://twitter.com/getdoks","https://github.com/h-enk/doks"],"logo":{"@type":"ImageObject","@id":"https://otter-framework.dev/#/schema/image/1","url":"https://otter-framework.dev/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"https://otter-framework.dev/#/schema/image/1"}},{"@type":"WebSite","@id":"https://otter-framework.dev/#/schema/website/1","url":"https://otter-framework.dev/","name":"Otter","description":"Otter is a drop-in solution that facilitates peer-to-peer video communication within web applications.","publisher":{"@id":"https://otter-framework.dev/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://otter-framework.dev/docs/case-study/web-rtc/","url":"https://otter-framework.dev/docs/case-study/web-rtc/","name":"How WebRTC Works","description":"","isPartOf":{"@id":"https://otter-framework.dev/#/schema/website/1"},"about":{"@id":"https://otter-framework.dev/#/schema/organization/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://otter-framework.dev/docs/case-study/web-rtc/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://otter-framework.dev/docs/case-study/web-rtc/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://otter-framework.dev/docs/case-study/web-rtc/"]}]},{"@type":"BreadcrumbList","@id":"https://otter-framework.dev/docs/case-study/web-rtc/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://otter-framework.dev/","url":"https://otter-framework.dev/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://otter-framework.dev/docs/","url":"https://otter-framework.dev/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://otter-framework.dev/docs/case-study/","url":"https://otter-framework.dev/docs/case-study/","name":"Case Study"}},{"@type":"ListItem","position":4,"item":{"@id":"https://otter-framework.dev/docs/case-study/web-rtc/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://otter-framework.dev/#/schema/article/1","headline":"How WebRTC Works","description":"","isPartOf":{"@id":"https://otter-framework.dev/docs/case-study/web-rtc/"},"mainEntityOfPage":{"@id":"https://otter-framework.dev/docs/case-study/web-rtc/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://otter-framework.dev/#/schema/person/2"},"publisher":{"@id":"https://otter-framework.dev/#/schema/organization/1"},"image":{"@id":"https://otter-framework.dev/docs/case-study/web-rtc/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://otter-framework.dev/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/h-enk"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://otter-framework.dev/docs/case-study/web-rtc/#/schema/image/2","url":"https://otter-framework.dev/doks.png","contentUrl":"https://otter-framework.dev/doks.png","caption":"How WebRTC Works"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://otter-framework.dev/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://otter-framework.dev/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://otter-framework.dev/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://otter-framework.dev/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://otter-framework.dev/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://otter-framework.dev/site.webmanifest></head><body class="docs single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0 mb-2" href=https://otter-framework.dev/ aria-label=Otter><img class=logo-light src=https://otter-framework.dev/images/otter-main-light.png width=90px>
<img class="logo-dark d-none" src=https://otter-framework.dev/images/otter-main.png width=90px></a>
<button class="btn btn-link order-0 ms-auto d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasExample aria-controls=offcanvasExample><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasExample aria-labelledby=offcanvasExampleLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasExampleLabel>Browse docs</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label=Close></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Case Study</h3><ul class=list-unstyled><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/introduction/>Introduction</a></li><li><a class="docs-link active" href=https://otter-framework.dev/docs/case-study/web-rtc/>How WebRTC Works</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/existing-solutions/>Existing Solutions</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/introducing-otter/>Introducing Otter</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/how-otter-is-built/>How Otter is Built</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/engineering-challenges/>Engineering Challenges</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/future-work/>Future Work</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/references/>References</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/about-us/>About Us</a></li></ul><h3 class="h6 text-uppercase mb-2">Documentation</h3><ul class=list-unstyled><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/commands/>Commands</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/how-to-update/>How to Update</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/troubleshooting/>Troubleshooting</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/otter-api/>Otter API</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/how-to-use-otter/>How to Use Otter</a></li></ul></nav></aside></div></div><button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://otter-framework.dev/>Otter</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://otter-framework.dev/docs/case-study/introduction/>Case Study</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://otter-framework.dev/docs/documentations/>Documentations</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Get Started
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://otter-framework.dev/docs/case-study/quick-start/>Quick Start</a></li><li><a class=dropdown-item href=https://getdoks.org/tutorial/introduction/>Tutorial</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/otter-framework><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Case Study</h3><ul class=list-unstyled><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/introduction/>Introduction</a></li><li><a class="docs-link active" href=https://otter-framework.dev/docs/case-study/web-rtc/>How WebRTC Works</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/existing-solutions/>Existing Solutions</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/introducing-otter/>Introducing Otter</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/how-otter-is-built/>How Otter is Built</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/engineering-challenges/>Engineering Challenges</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/future-work/>Future Work</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/references/>References</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/about-us/>About Us</a></li></ul><h3 class="h6 text-uppercase mb-2">Documentation</h3><ul class=list-unstyled><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/commands/>Commands</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/how-to-update/>How to Update</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/troubleshooting/>Troubleshooting</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/otter-api/>Otter API</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/how-to-use-otter/>How to Use Otter</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-4 col-xl-3 docs-sidebar d-none d-lg-block"><nav id=sidebar-default class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Case Study</h3><ul class=list-unstyled><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/introduction/>Introduction</a></li><li><a class="docs-link active" href=https://otter-framework.dev/docs/case-study/web-rtc/>How WebRTC Works</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/existing-solutions/>Existing Solutions</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/introducing-otter/>Introducing Otter</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/how-otter-is-built/>How Otter is Built</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/engineering-challenges/>Engineering Challenges</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/future-work/>Future Work</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/references/>References</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/case-study/about-us/>About Us</a></li></ul><h3 class="h6 text-uppercase mb-2">Documentation</h3><ul class=list-unstyled><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/commands/>Commands</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/how-to-update/>How to Update</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/troubleshooting/>Troubleshooting</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/otter-api/>Otter API</a></li><li><a class=docs-link href=https://otter-framework.dev/docs/documentations/how-to-use-otter/>How to Use Otter</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#how-do-peers-connect>How do Peers Connect?</a></li><li><a href=#technical-discussion>Technical Discussion</a><ul><li></li></ul></li><li><a href=#notes>Notes</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#how-do-peers-connect>How do Peers Connect?</a></li><li><a href=#technical-discussion>Technical Discussion</a><ul><li></li></ul></li><li><a href=#notes>Notes</a></li></ul></nav></div></nav><main class="docs-content col-lg-12 col-xl-10"><h1>How WebRTC Works</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#how-do-peers-connect>How do Peers Connect?</a></li><li><a href=#technical-discussion>Technical Discussion</a><ul><li></li></ul></li><li><a href=#notes>Notes</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#how-do-peers-connect>How do Peers Connect?</a></li><li><a href=#technical-discussion>Technical Discussion</a><ul><li></li></ul></li><li><a href=#notes>Notes</a></li></ul></nav></div></nav><h2 id=how-do-peers-connect>How do Peers Connect? <a href=#how-do-peers-connect class=anchor aria-hidden=true>#</a></h2><p>Let’s look at a high-level workflow of how a <strong>direct</strong> connection can be established between two peers. We will use an analogy of a peer Alice sending physical mail to another peer Bob.</p><p>How does Alice know where to address her mail to?</p><p>Alice will need some mechanism to exchange addresses with Bob to facilitate the delivery, which is known as <strong>signaling</strong>. This could be a text message or even a pigeon carrier. In practice, this is typically facilitated by a server.</p><p>Let’s suppose Alice and Bob are in the same building. All communication passes via the signaling mechanism. Alice informs Bob that she is interested in sending him mail but she needs his room number. Bob responds with this information and Alice is then able to deliver the mail <strong>directly</strong>.</p><p>While this is ideal, what happens if Alice is actually in a different building than Bob?</p><p>Alice and Bob may know each other’s room number, but this information is rather useless outside of their respective buildings unless they also know their buildings’ addresses. To find their respective building addresses, they can each ask their building doorman.</p><p>Now with a building address and room number, they can communicate this information using the same signaling mechanism. Alice can visit Bob’s building and deliver the mail herself <strong>directly</strong>.</p><p>What if Alice is traveling and ends up in a different city, state or country than Bob?</p><p>In this case, Alice is not able to <strong>directly</strong> deliver the mail to Bob herself, so she must resort to <strong>delegating</strong> the delivery work to a courier.</p><p>To summarize our analogy, for Alice and Bob to exchange addresses and connect there are up to three possible methods (delivering directly themselves or with the help of a doorman and courier). Each requires a different approach. Mapping this analogy to WebRTC, a signaling server and other servers (i.e. the building doorman and courier) are required in order to reliably establish a WebRTC connection (i.e. to deliver mail).</p><p>Next, we will take a more technical look at these components and discuss how they work together.</p><h2 id=technical-discussion>Technical Discussion <a href=#technical-discussion class=anchor aria-hidden=true>#</a></h2><h4 id=signaling-server>Signaling Server <a href=#signaling-server class=anchor aria-hidden=true>#</a></h4><p>The sole responsibility of a signaling server is to relay messages between peers who wish to connect. This relay allows peers to exchange critical information required to establish a direct P2P connection. However, the WebRTC specification does not actually describe how to implement a signaling server. Instead, the implementation details are left to the developer, since an existing backend infrastructure (serving some other purpose) could also be utilized to serve this function.</p><p>The structure of the information relayed is governed by the Session Description Protocol (SDP), a simple key-value text-based protocol. Some of the information contained within the SDP includes:</p><ul><li>The IP addresses through which each peer can be reached.</li><li>The media streams, either audio, video, or both, that each peer wishes to send to the other peer.</li><li>The different codecs available to both peers to encode and decode the media streams.</li></ul><p>In WebRTC terminology, initializing a call requires peer A to send an “offer” to peer B who responds with an “answer”. The offer and answer represent each peer’s respective session description and these are exchanged through a process known as “negotiation”. With this information a direct P2P connection can be established.</p><p>This exchange of session descriptions occurs during the initial phase of the call but also any time the state of the session changes. If a peer decides to send a new media stream or begins experiencing network issues, a new “offer” and “answer” will be dispatched between the peers through the signaling channel. It is therefore not uncommon to have multiple negotiation phases between peers during a single session. The ability of the underlying application to handle this uncertainty regarding the state of the session is crucial in providing a seamless user experience. This is easier said than done, which we will explore when discussing the engineering challenges that we faced while building Otter.</p><h4 id=network-address-translation>Network Address Translation <a href=#network-address-translation class=anchor aria-hidden=true>#</a></h4><p>One of the fundamental rules for all communication over the Internet is that every participating host must be assigned a public IP address. Under IPv4, an IP address represents a sequence of 32 bits divided into 4 octets of 8 bits each, which means that every octet has 2^8, or 256, possibilities. Therefore, there is an upper bound of ~4.3 billion on the total number of IPv4 addresses available in the world. With the ever-increasing number of devices connected to the Internet, engineers realized that this upper bound would be reached sooner than expected. To address this issue, Network Address Translation (NAT) was proposed.</p><p>The NAT solution allows hosts within a private network to share a pool of public IP addresses to communicate over the Internet. For example, an internal host who wishes to send a message over the Internet will first send it to their NAT device, which will then change the source IP address on the packet to a public IP address chosen from its pool of available IP addresses. The NAT device keeps track of which hosts are currently assigned a public IP address to be able to route messages from the Internet to the appropriate internal host. Even though NAT does address some problems related to the availability of IP addresses, it also creates new ones for UDP traffic.</p><p>Recall every TCP connection has a well-defined communication flow. NAT devices rely on this underlying flow to determine when a connection is first established and when it is closed. This allows a NAT device to do the following:</p><ul><li>During the exchange to open a connection, assign a public IP address to an internal host for the lifetime of the connection.</li><li>During the exchange of application data, route messages between the internal and external hosts.</li><li>During the exchange to close the connection, remove the assigned public IP address and make it available to other internal hosts.</li></ul><p>UDP, on the other hand, is connectionless. Unpredictable connection state is a major issue for NAT devices as they can no longer rely on the underlying communication flow to manage outbound and inbound packets appropriately. This makes it difficult for internal hosts to maintain a stable communication channel with external hosts. Since WebRTC relies on UDP, how does it resolve the missing connection state?</p><h4 id=stun--turn-servers>STUN & TURN Servers <a href=#stun--turn-servers class=anchor aria-hidden=true>#</a></h4><p>The answer lies within the fact that both peers need a public IP address. Like the room numbers inside the different buildings, a private IP address is useless outside of its private network. The solution is a Session Traversal Utilities for NAT (STUN) server.</p><p>A STUN server allows hosts within a private network to programmatically create a mapping in the routing table of the NAT device. The response of the STUN server will include a header indicating the IP address and port of the NAT mapping. STUN also periodically sends empty messages through the NAT device, which benefits UDP traffic by keeping the NAT mapping and thus connection state alive. This mapping can be relayed to the other peer through the signaling channel. Both peers now have a public IP address. Connecting…</p><p>Not so fast! There are still situations where the above is not sufficient. When a NAT device creates a mapping within its routing table, it becomes responsible for routing outbound and inbound packets for the mapping. The way that inbound packets are routed and filtered can vary depending on the NAT device and its configuration.</p><p>In any case, inbound packets that are not allowed to use a specific mapping in the routing table are simply discarded by the NAT device. Depending on the filtering behavior of the NAT devices, communication between peers by using IP addresses and ports obtained through STUN servers may not be possible.</p><p>Furthermore, even if the NAT devices are not obstacles to a direct connection, private network firewalls can be. Firewalls can block traffic from certain port ranges or even block UDP traffic altogether. Analogous to how a courier helped Alice delegate her delivery, a workaround will be needed to establish a connection. The solution, a Traversal Using Relays around NAT (TURN) server.</p><p>If all else fails, a TURN server will act as a middleman between the peers. A peer that requires its packets to be relayed can simply send them to the TURN server. The TURN server then “dumbly” relays the packets to the other peer, without concern for its contents. The other peer is not aware that the packets are now being relayed.</p><p>Using a TURN server is a last resort as it adds latency to the communication and increases the operating costs of the system due to the significant bandwidth usage. However, to allow a seamless user experience, it is a required component of the overall infrastructure. In reality, the aforementioned scenario requiring a TURN server only affects a small percentage of end users. According to documentation from a Google application<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><ul><li>92% of the time the connection can take place directly (STUN).</li><li>8% of the time the connection requires a relay (TURN).</li></ul><p>In summary, a successful connection requires both peers to gather multiple IP address and port pairs through which they could potentially be reached. In WebRTC terminology, a pair is known as a “candidate transport address”. These candidates are then exchanged between peers through the signaling channel. All possible combinations of candidates from both peers are then tested for connectivity establishment (i.e. if both peers have 3 candidates, 9 possible routes will be tested). Determining the most efficient path between peers on the network is critical and justifies the need for a STUN and TURN server in a WebRTC P2P topology.</p><h2 id=notes>Notes <a href=#notes class=anchor aria-hidden=true>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://hpbn.co/building-blocks-of-udp/#stun-and-turn-in-practice>High Performance Browser Networking</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a href=https://otter-framework.dev/docs/case-study/introduction/><div class="card my-1"><div class="card-body py-2">&larr; Introduction</div></div></a><a class=ms-auto href=https://otter-framework.dev/docs/case-study/existing-solutions/><div class="card my-1"><div class="card-body py-2">Existing Solutions &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://www.netlify.com/>Netlify</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://otter-framework.dev/js/bootstrap.min.87685cf4e6585276ff9e7b5d0b97e792615af6921e77821315d1ca7c5511ac2f30667e16c0d031e680ca8b57f63f6c0f6c4a232da777cce474b501ed81e090a9.js integrity="sha512-h2hc9OZYUnb/nntdC5fnkmFa9pIed4ITFdHKfFURrC8wZn4WwNAx5oDKi1f2P2wPbEojLad3zOR0tQHtgeCQqQ==" crossorigin=anonymous defer></script>
<script src=https://otter-framework.dev/js/highlight.min.56a414730f1135fe77b5ea30bf74a2cc4101a6f386e85e5b789c800570cc33d33054000f45932c053a59b41018f72687867254a80e1b9710671852492533162f.js integrity="sha512-VqQUcw8RNf53teowv3SizEEBpvOG6F5beJyABXDMM9MwVAAPRZMsBTpZtBAY9yaHhnJUqA4blxBnGFJJJTMWLw==" crossorigin=anonymous defer></script>
<script src=https://otter-framework.dev/main.min.48112dadd832db3af6d4d33366c964d3fbb9a6650b84f6a6bc5e79c3ba86d94a2e7fe3515d588ad342a14de3260a6ffd2f49830115f6213a7e3b563ff9de1801.js integrity="sha512-SBEtrdgy2zr21NMzZslk0/u5pmULhPamvF55w7qG2Uouf+NRXViK00KhTeMmCm/9L0mDARX2ITp+O1Y/+d4YAQ==" crossorigin=anonymous defer></script>
<script src=https://otter-framework.dev/index.min.794cea15a151943ac139a010f8e8f1346df09d06426abde8e0f91d9259af5efc841496ae66978203bff6472fa0b0bb98ada11d68948b52f8c431d7b813a9c78a.js integrity="sha512-eUzqFaFRlDrBOaAQ+OjxNG3wnQZCar3o4PkdklmvXvyEFJauZpeCA7/2Ry+gsLuYraEdaJSLUvjEMde4E6nHig==" crossorigin=anonymous defer></script><div class="d-flex fixed-bottom pb-4 pb-lg-5 pe-4 pe-lg-5"><a id=toTop href=# class="btn btn-outline-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"/></svg></a></div></body></html>